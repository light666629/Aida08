<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ucapan Ulang Tahun untuk AidaüéÇ</title>
  <style>
    body {
      position: relative;
      height: 100vh;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      white-space: pre-line;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
      overflow-y: auto;
      overflow-x: hidden;
    }
    .bg {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  transition: opacity 3s ease-in-out; /* fade halus 3 detik */
  z-index: -2;
  opacity: 0;
  filter: brightness(0.95) contrast(1.05);
    }
    #bg1 { opacity: 1; }
    .overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0,0,0,0.5);
      z-index: 0;
    }
    #loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 30px;
      position: relative;
      z-index: 2;
      color: white;
      font-size: 1.5rem;
      user-select: none;
      font-weight: bold;
      letter-spacing: 0.15em;
      font-family: 'Courier New', Courier, monospace;
    }
    #loadingText { margin-bottom: 20px; }
    #loadingDots { display: flex; gap: 10px; }
    .dot {
      width: 15px;
      height: 15px;
      background: #ff4081;
      border-radius: 50%;
      opacity: 0.3;
      animation: blink 1.5s infinite;
    }
    .dot:nth-child(1) { animation-delay: 0s; }
    .dot:nth-child(2) { animation-delay: 0.3s; }
    .dot:nth-child(3) { animation-delay: 0.6s; }
    .dot:nth-child(4) { animation-delay: 0.9s; }
    .dot:nth-child(5) { animation-delay: 1.2s; }
    @keyframes blink {
      0%, 20% { opacity: 0.3; }
      50% { opacity: 1; }
      100% { opacity: 0.3; }
    }

    /* üéÅ Gift */
    #gift {
      font-size: 100px;
      cursor: pointer;
      user-select: none;
      position: relative;
      z-index: 2;
      transition: transform 0.3s ease, opacity 0.8s ease;
      text-shadow: 0 0 10px #ff4081;
      display: none;
      opacity: 1;
    }
    #gift:hover { transform: scale(1.1) rotate(10deg); }
    #gift.open {
      animation: openGift 1s forwards;
      cursor: default;
      transform-origin: center bottom;
      text-shadow: 0 0 20px #ff4081;
    }
    @keyframes openGift {
      0% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.2) rotate(15deg); }
      100% { transform: scale(1) rotate(0deg); }
    }

    /* ‚ú® Message */
    #message {
      font-size: 1.5rem;
      max-width: 600px;
      max-height: 80vh;
      line-height: 1.6;
      white-space: pre-line;
      display: none;
      position: relative;
      z-index: 4;
      user-select: none;
      color: #fff;
      text-shadow: 0 0 6px rgba(255,64,129,0.9);
      opacity: 0;
      animation: fadeIn 1s forwards;
      margin-top: 20px;
      overflow-y: auto;
      padding: 10px;
      box-sizing: border-box;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    /* ‚ö° Overlay putih transisi */
    #whiteOverlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: white;
      opacity: 0;
      pointer-events: none;
      z-index: 10;
      transition: opacity 1s ease;
    }

    /* üéâ Confetti */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #ff4081;
      opacity: 0.9;
      top: 0;
      animation: confettiFall 3s linear forwards;
      z-index: 3;
      border-radius: 3px;
      pointer-events: none;
      user-select: none;
    }
    @keyframes confettiFall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }

    /* üéµ Tombol Musik Glowing */
    #musicBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 8px 16px;
      font-size: 1rem;
      border: 2px solid #ff4081;
      border-radius: 30px;
      background: rgba(255, 64, 129, 0.2);
      color: #ff4081;
      cursor: pointer;
      z-index: 4;
      box-shadow: none;
      transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
      user-select: none;
      overflow: hidden;
    }
    #musicBtn:hover {
      background: #ff4081;
      color: white;
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(255,64,129,0.6);
    }
    #musicBtn.playing::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 120%;
      height: 120%;
      border-radius: 50%;
      border: 2px solid rgba(255,64,129,0.6);
      transform: translate(-50%, -50%) scale(0.8);
      opacity: 0;
      animation: pulse 1.5s infinite;
      pointer-events: none;
    }
    @keyframes pulse {
      0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1.4); opacity: 0; }
    }

    /* üí• Potongan Gift */
    .gift-piece {
      position: absolute;
      width: 20px;
      height: 20px;
      background: #ff4081;
      border-radius: 4px;
      pointer-events: none;
      user-select: none;
      opacity: 1;
      animation: explode 1s forwards;
      z-index: 3;
    }
    @keyframes explode {
      to {
        transform: translate(var(--x), var(--y)) rotate(720deg) scale(0);
        opacity: 0;
      }
    }

    /* üåßÔ∏è Item jatuh */
    .falling-item {
      position: fixed;
      pointer-events: none;
      user-select: none;
      z-index: 2;
      animation: fall 5s linear forwards;
      font-weight: bold;
    }
    @keyframes fall {
      0% { transform: translateY(-10vh) scale(0.8) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      100% { transform: translateY(110vh) scale(1.2) rotate(360deg); opacity: 0; }
    }
    #gift:focus {
  outline: none;
  box-shadow: none;
}
#message {
  scroll-behavior: smooth;
}
  </style>
</head>
<body>
  <div id="bg1" class="bg"></div>
  <div id="bg2" class="bg"></div>
  <div class="overlay"></div>

  <div id="loading">
    <div id="loadingText">LOADING</div>
    <div id="loadingDots">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
  </div>

  <div id="gift" title="Klik untuk buka kado" role="button">üéÅ</div>
  <div id="message"></div>
  <div id="whiteOverlay"></div>
  <button id="musicBtn" onclick="toggleMusic()">üéµ Play Musik</button>
  <audio id="musik" loop>
    <source src="lagu-ultah.mp3" type="audio/mpeg" />
    Browser Anda tidak mendukung elemen audio.
  </audio>

  <script>
    /* ---------------------------
       Element references & state
       --------------------------- */
    const loadingDiv = document.getElementById('loading');
    const giftDiv = document.getElementById('gift');
    const messageDiv = document.getElementById('message');
    const whiteOverlay = document.getElementById('whiteOverlay');
    const musik = document.getElementById('musik');
    const musicBtn = document.getElementById('musicBtn');
    const bg1 = document.getElementById('bg1');
    const bg2 = document.getElementById('bg2');

    let isPlaying = false;
    let messageIndex = 0;
    let charIndex = 0;
    let isTyping = false;
    let alertShown = false;
    let fallingInterval = null;
    let bgInterval = null;
    let currentBgIndex = 0;
    let showingBg1 = true;

    /* ---------------------------
       Content arrays
       --------------------------- */
    const messages = [
  "Hai Aida Rahma Putri üòÜ",
  "Selamat ulang tahun bocil dewasa üéÇ‚ú®",
  "Semoga makin banyak hal random yang bikin kamu ketawa hari ini üòÇ",
  "Semoga makin waras, meski kayaknya udah gak mungkin üòú",
  "Makin kuat, makin santai, makin cuek sama omongan orang yang jelek üí™",
  "Dan semoga rezeki kamu lancar,\nbiar bisa traktir aku juga üòÖ üçï",
  "Pokoknya semoga kamu bahagia tanpa syarat,\nkayak nasi padang yang gak pernah salahüçõ",
  "Jangan tanya aku\nkenapa nasi padang yang ga pernah salah,\nsoalnya aku juga gatauüòÇ",
  "Oh iya... Semoga moodyan kamu mulai pensiun,\nbiar gak ada lagi yang jadi korban emosi tiba-tiba ü§£",
  "Sehat selalu, jangan sakit-sakit ya,\nsakitnya dikit aja ü§®",
  "Jangan suka bilang ‚Äòaku gapapa‚Äô\npadahal udah pengen marah ke semesta üò§",
  "Udah ah, kebanyakan doa bagus takut kamu gak kuat jadi perfect ü§£",
  "Sekarang waktunya senyum,\nbukan karena hidup sempurna,\ntapi karena semua udah nunggu traktiran kamu ü§£",
  "Yang paling penting nihhh!\nterakhir ü§®\njangan lupa makan kue üòÖ",
  "Happy birthday Aidaaa~ üéâüéÇüéà"
];
    const backgrounds = [
      'background1.png','background2.png','background3.png','background4.jpg','background5.jpg','background6.jpg','background7.jpg','background8.png'
    ];
    const loadingBackground = 'background0.png';

    /* ---------------------------
       Utility: ganti background
       --------------------------- */
    function changeBackground() {
      const nextIndex = (currentBgIndex + 1) % backgrounds.length;
      if (showingBg1) {
        bg2.style.backgroundImage = `url('${backgrounds[nextIndex]}')`;
        bg2.style.opacity = '1';
        bg1.style.opacity = '0';
      } else {
        bg1.style.backgroundImage = `url('${backgrounds[nextIndex]}')`;
        bg1.style.opacity = '1';
        bg2.style.opacity = '0';
      }
      showingBg1 = !showingBg1;
      currentBgIndex = nextIndex;
      console.log('Background ->', backgrounds[nextIndex]);
    }

    /* ---------------------------
       Create falling "hujan" item
       --------------------------- */
    function createFallingItem() {
  // biarin jalan juga di layar kecil
  // if (window.innerWidth < 480) {
  //   return;
  // }

      const loveItems = ['‚ù§Ô∏è', 'üíï', 'üíñ', 'üíù', 'üíó', 'üòç', 'üåπ'];
      const birthdayItems = ['üéÅ', 'üéà', 'üéÇ', 'üéâ', 'üéä', 'üéÄ', '‚ú®', 'ü•≥'];
      const allItems = [...loveItems, ...birthdayItems];
      const selected = allItems[Math.floor(Math.random() * allItems.length)];

      const item = document.createElement('div');
      item.classList.add('falling-item');
      item.textContent = selected;

      const fontSize = (Math.random() * 14) + 16; // 16-30px
      const leftPos = Math.random() * 100; // vw

      const isLove = loveItems.includes(selected);
      const color = isLove ? '#ff69b4' : '#ff4081';
      const shadow = isLove ? 'rgba(255,105,180,0.8)' : 'rgba(255,64,129,0.8)';

      item.style.cssText = `
        left: ${leftPos}vw;
        top: -60px;
        font-size: ${fontSize}px;
        color: ${color};
        text-shadow: 0 0 8px ${shadow};
        animation-delay: ${Math.random() * 1}s;
      `;

      document.body.appendChild(item);
      // remove after animation
      setTimeout(()=> {
        if (item.parentNode) item.remove();
      }, 6000);
    }

    /* ---------------------------
       Start hujan (tanpa auto-stop)
       --------------------------- */
    function startFallingItems() {
      console.log('Mulai hujan: fallingInterval set');
      if (fallingInterval) {
        clearInterval(fallingInterval);
        fallingInterval = null;
      }
      fallingInterval = setInterval(createFallingItem, 250); // tweak interval for density
    }

    /* ---------------------------
       Confetti & gift-piece explosion
       --------------------------- */
    function createConfetti(x=null, y=null) {
      const conf = document.createElement('div');
      conf.classList.add('confetti');
      conf.style.left = (x !== null ? x : Math.random() * window.innerWidth) + 'px';
      conf.style.top = (y !== null ? y : -20) + 'px';
      conf.style.backgroundColor = `hsl(${Math.random()*360},70%,60%)`;
      const size = Math.random() * 8 + 5;
      conf.style.width = conf.style.height = size + 'px';
      conf.style.animationDuration = (2 + Math.random()*2) + 's';
      document.body.appendChild(conf);
      setTimeout(()=> conf.remove(), 3500);
    }

    function explodeGift(element, piecesCount = 30) {
      const rect = element.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;

      // gift-piece fragments
      for (let i=0;i<piecesCount;i++){
        const piece = document.createElement('div');
        piece.classList.add('gift-piece');
        piece.style.left = (cx - 10) + 'px';
        piece.style.top = (cy - 10) + 'px';
        const angle = Math.random() * Math.PI * 2;
        const dist = 80 + Math.random() * 160;
        const x = Math.cos(angle) * dist + 'px';
        const y = Math.sin(angle) * dist + 'px';
        piece.style.setProperty('--x', x);
        piece.style.setProperty('--y', y);
        piece.style.background = `hsl(${Math.random()*360},70%,60%)`;
        document.body.appendChild(piece);
        piece.addEventListener('animationend', ()=> piece.remove());
      }

      // burst confetti
      for (let i=0;i<40;i++){
        setTimeout(()=> createConfetti(cx + (Math.random()*100-50), cy + (Math.random()*80-40)), i*20);
      }

      console.log('Explode gift with pieces:', piecesCount);
    }

    /* ---------------------------
       Typewriter untuk message
       --------------------------- */
    function typeWriter() {
  if (!isTyping) isTyping = true;
  if (messageIndex < messages.length) {
    if (charIndex < messages[messageIndex].length) {
      messageDiv.textContent += messages[messageIndex].charAt(charIndex);
      messageDiv.scrollTop = messageDiv.scrollHeight; // ‚¨ÖÔ∏è auto-scroll tiap huruf
      charIndex++;
      setTimeout(typeWriter, 80 + Math.random()*60);
    } else {
      messageDiv.textContent += "\n\n";
      messageIndex++;
      charIndex = 0;
      setTimeout(typeWriter, 700);
    }
  } else {
    isTyping = false;
    console.log('Typing selesai');
        // optional final alert (kept minimal)
        setTimeout(()=> {
          try { alert("üéâ Selamat ulang tahun, Aida Rahma Putri!"); } catch(e){}
        }, 200);
      }
    }

    /* ---------------------------
       Simulate loading -> show gift
       --------------------------- */
    function simulateLoadingGame(duration = 4000) {
      setTimeout(()=>{
        loadingDiv.style.display = 'none';
        giftDiv.style.display = 'block';
        bg1.style.backgroundImage = `url('${backgrounds[0]}')`;
        bg1.style.opacity = '1';
        bg2.style.opacity = '0';
        console.log('Loading selesai - gift muncul');
      }, duration);
    }

    /* ---------------------------
       Helper: keyboard support for gift
       --------------------------- */
    giftDiv.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        giftDiv.click();
      }
    });

    /* ---------------------------
       Auto-focus gift after loading
       --------------------------- */
    setTimeout(()=>{
      if (giftDiv.style.display !== 'none') {
        giftDiv.focus();
        console.log('Auto-focus gift');
      }
    }, 4100);
    /* ---------------------------
       Event klik gift (efek buka kado + hujan + teks)
       --------------------------- */
    giftDiv.addEventListener('click', () => {
      if (giftDiv.classList.contains('open')) return;

      giftDiv.classList.add('open');
      giftDiv.style.cursor = 'default';
      console.log('Gift dibuka - mulai explode & animasi!');

      setTimeout(() => {
        // üí• Ledakan kado + confetti warna-warni
        explodeGift(giftDiv, 25);
        giftDiv.style.transition = 'opacity 0.8s ease';
        giftDiv.style.opacity = '0';

        // üåßÔ∏è Langsung mulai hujan abadi
        startFallingItems();

        // üåà Mulai ganti background tiap 2 detik
        bgInterval = setInterval(changeBackground, 5000); // üåÑ ganti background tiap 5 detik

        // ‚ú® Overlay putih fade in & out
        setTimeout(() => {
          whiteOverlay.style.opacity = '1';
          setTimeout(() => {
            whiteOverlay.style.opacity = '0';
          }, 1000);
        }, 800);

        // üéµ Musik auto-play
        setTimeout(() => {
          musik.play().catch(e => console.log('Autoplay gagal:', e));
          musicBtn.textContent = "‚è∏ Pause Musik";
          musicBtn.classList.add("playing");
          isPlaying = true;
        }, 1200);

        // üí¨ Tampilkan pesan setelah fade
        setTimeout(() => {
          giftDiv.style.display = 'none';
          messageDiv.style.display = 'block';
          messageDiv.style.opacity = 0;
          messageDiv.style.animation = 'fadeIn 1s forwards';
          typeWriter();
        }, 1800);

      }, 1000); // delay animasi openGift
    });

    /* ---------------------------
       Tombol musik toggle play/pause
       --------------------------- */
    function toggleMusic() {
      if (isPlaying) {
        musik.pause();
        musicBtn.textContent = "üéµ Play Musik";
        musicBtn.classList.remove("playing");
        isPlaying = false;
        console.log('Musik dipause');
      } else {
        musik.play().catch(e => console.log('Play error:', e));
        musicBtn.textContent = "‚è∏ Pause Musik";
        musicBtn.classList.add("playing");
        isPlaying = true;
        console.log('Musik diputar');
      }
    }

    /* ---------------------------
       Window load: mulai loading + tampil gift
       --------------------------- */
    window.addEventListener('load', () => {
      bg1.style.backgroundImage = `url('${loadingBackground}')`;
      bg1.style.opacity = '1';
      bg2.style.opacity = '0';
      simulateLoadingGame(4000);
      console.log('Halaman siap - semua sistem on!');
    });
  </script>
</body>
</html>
